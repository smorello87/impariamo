<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Impariamo l'Italiano! - Fiore</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- CSS loaded dynamically to prevent caching -->
  <script src="js/css-loader.js"></script>
  <style>
    /* Game-specific styles that are unique to Fiore */
    /* These styles are specific to the flower game mechanics */
    .controls {
      display: flex;
      gap: 1em;
      justify-content: center;
      width: 100%;
    }

    #game {
      min-height: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      row-gap: 1.5em;
      text-align: center;
    }

    #setup {
      min-height: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding-top: 1.5em;
      row-gap: 1.5em;
      text-align: center;
    }

    #game { display: none; }

    #hangman { margin-bottom: 0.5em; font-weight: bold; }

    @media (max-width: 600px) {
      #letters {
        grid-template-columns: repeat(7, 1fr);
      }
    }
      footer {
    margin-top: auto;  /* push it to the very bottom in a flex column */
  }
    }
  </style>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QJL9EQGT3Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-QJL9EQGT3Y');
  </script>
</head>
<body>
  <header>
    <h1>Impariamo l'Italiano!</h1>
  </header>
  <nav>
    <div class="hamburger" onclick="toggleMenu()">â˜°</div>
    <div class="menu-items">
      <a href="index.html">Home</a>
      <div class="dropdown">
        <a href="#">Spin the Wheel</a>
        <div class="dropdown-content">
          <a href="tenses.html">Verb Tenses</a>
          <a href="reflexives.html">Reflexives</a>
        </div>
      </div>
      <a href="memory.html">Memory Game</a>
      <a href="wordle.html">Wordle</a>
      <a href="fiore.html" class="active">Fiore</a>
    </div>
  </nav>

 

  <main class="container">
    <div id="setup" class="tool">
      <h2>Livello</h2>
      <select id="difficulty">
        <option value="facile">Facile</option>
        <option value="medio">Medio</option>
        <option value="difficile">Difficile</option>
      </select>
      <button id="startBtn">Inizia</button>
    </div>

    <div id="game">
      <div id="hangman">Tentativi rimasti: <span id="lives"></span></div>
      <div id="word"></div>
      <div id="letters"></div>
      <div id="message"></div>
      <div id="image-container">
        <img id="hangmanImage" src="" alt="Fiore che sboccia">
        <div class="controls">
          <button id="restartBtn">Ricomincia</button>
          <button id="changeLevelBtn">Cambia livello</button>
        </div>
      </div>
      </div>
  </main>

  <footer>
    <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://beatricecarnelutti.com/impariamo">Impariamo l'Italiano!</a> by <span property="cc:attributionName">Beatrice Carnelutti</span> is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a>
     </footer>

  <script>
    // Nav hamburger toggle
    function toggleMenu() {
      document.querySelector('.menu-items').classList.toggle('show-menu');
    }

    // Impiccato logic
    const totalLives = 8;
    const words = {
      facile: [
        "casa","pane","mela","luna","sole","cane","gatto","tavolo","sedia","libro",
        "porta","finestra","acqua","mare","notte","giorno","scarpa","pasta","vino","amico",
        "fiore","anima","cuore","letto","cielo","bacio","orso","albero","bicicletta","moneta"
      ],
      medio: [
        "pomodoro","scuola","famiglia","ragazzo","ragazza","amore","bambino","cucchiaio","magazzino","giardino",
        "ospedale","professore","bicchiere","montagna","stazione","telefono","occhiali","biblioteca","scienza","atmosfera",
        "archivio","fotografia","telefonino","parco","piscina","edicola","cortile","cucina","zucchero","mattina"
      ],
      difficile: [
        "architettura","caratteristica","costituzionale","internazionalizzazione","neurotrasmettitore","paleontologia",
        "elettrocardiogramma","elettroencefalogramma","incommensurabile","sovrappopolazione","stratificazione","antropologico",
        "dichiarazione","responsabilitÃ ","amministrazione","psicologicamente","etimologicamente","fenomenologia","sovraccarico",
        "distribuzione","interpretazione","tradizionalmente","fotolitografia","microbiologia","idrogeologia","elettrodomestico",
        "ornitologia","glottologia","autoimmunizzazione","binominalmente"
      ]
    };

let answer = '', displayed = [], lives = totalLives, gameOver = false;
const setupEl        = document.getElementById('setup');
const gameEl         = document.getElementById('game');
const startBtn       = document.getElementById('startBtn');
const restartBtn     = document.getElementById('restartBtn');
const changeLevelBtn = document.getElementById('changeLevelBtn');

startBtn.addEventListener('click', startGame);
restartBtn.addEventListener('click', startGame);
changeLevelBtn.addEventListener('click', () => {
  gameEl.style.display  = 'none';
  setupEl.style.display = 'flex';
});

function startGame() {
  const level = document.getElementById('difficulty').value;
  answer = words[level][Math.floor(Math.random()*words[level].length)].toUpperCase();
  displayed = Array(answer.length).fill('_');
  lives = totalLives;
  gameOver = false;

  document.getElementById('lives').textContent   = lives;
  document.getElementById('message').textContent = '';
  document.getElementById('hangmanImage').src    = `flower/flower0.jpg`;

  setupEl.style.display = 'none';
  gameEl.style.display  = 'flex';

  renderWord();
  createLetterButtons();
}

function renderWord() {
  document.getElementById('word').textContent = displayed.join(' ');
}

function createLetterButtons() {
  const container = document.getElementById('letters');
  container.innerHTML = '';
  for (let i = 65; i <= 90; i++) {
    const btn = document.createElement('button');
    btn.textContent = String.fromCharCode(i);
    btn.addEventListener('click', () => handleGuess(btn));
    container.appendChild(btn);
  }
}

function handleGuess(btn) {
  if (gameOver) return;
  const letter = btn.textContent;
  btn.disabled = true;
  let found = false;
  for (let i = 0; i < answer.length; i++) {
    if (answer[i] === letter) {
      displayed[i] = letter;
      found = true;
    }
  }
  if (!found) {
    lives--;
    document.getElementById('lives').textContent = lives;
    updateImage();
  }
  renderWord();
  checkEnd();
}

function checkEnd() {
  const msg = document.getElementById('message');
  if (!displayed.includes('_')) {
    msg.textContent = 'ðŸŽ‰ Hai vinto!';
    gameOver = true;
  } else if (lives === 0) {
    msg.textContent = `ðŸ˜¢ Hai perso. Parola: ${answer}`;
    gameOver = true;
  }
}

function updateImage() {
  const mistakes = totalLives - lives;
  document.getElementById('hangmanImage').src = `flower/flower${mistakes}.jpg`;
}

</script>
</body>
</html>